---
source: tests/integration_tests/init.rs
info:
  program: wt
  args:
    - init
    - xonsh
  env:
    GIT_AUTHOR_DATE: "2025-01-01T00:00:00Z"
    GIT_COMMITTER_DATE: "2025-01-01T00:00:00Z"
    GIT_CONFIG_GLOBAL: /dev/null
    GIT_CONFIG_SYSTEM: /dev/null
    GIT_EDITOR: ""
    LANG: C
    LC_ALL: C
    SOURCE_DATE_EPOCH: "1704067200"
---
success: true
exit_code: 0
----- stdout -----
# worktrunk shell integration for xonsh

def _wt_exec(args):
    """Helper function to parse wt output and handle directives"""
    # Capture full output including return code
    result = !(wt @(args))

    # Parse output line by line
    if result.out:
        for line in result.out.splitlines():
            if line.startswith("__WORKTRUNK_CD__"):
                # Extract path and change directory
                path = line[17:]  # Remove prefix
                cd @(path)
            else:
                # Regular output - print it
                print(line)

    # Return the exit code
    return result.returncode

def _wt_wrapper(args):
    """Override wt command to add --internal flag for switch and finish"""
    if not args:
        # No arguments, just run wt
        wt
        return

    subcommand = args[0]

    if subcommand in ["switch", "finish"]:
        # Commands that need --internal for directory change support
        rest_args = args[1:]
        return _wt_exec([subcommand, "--internal"] + rest_args)
    else:
        # All other commands pass through directly
        result = !(wt @(args))
        return result.returncode

# Register the alias
aliases['wt'] = _wt_wrapper



----- stderr -----

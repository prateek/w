# Worktrunk Project Configuration
# Location: <repo>/.config/wt.toml
#
# This file defines project-specific commands that run automatically during
# worktree operations. It should be checked into git and shared across all
# developers working on the project.

# Available template variables (all commands):
#   {repo}      - Repository name (e.g., "my-project")
#   {branch}    - Branch name (slashes replaced with dashes)
#   {worktree}  - Absolute path to the worktree
#   {repo_root} - Absolute path to the repository root
#
# Merge-related commands also support:
#   {target}    - Target branch for the merge (e.g., "main")

# Post-Create Commands
# Runs SEQUENTIALLY and BLOCKS until complete
# Use for: npm install, bundle install, build, essential setup
# The worktree switch won't complete until these finish
# Commands run one after another in the worktree directory
#
# Format options:
# 1. Single string:
#    post-create-command = "npm install"
#
# 2. Array (runs sequentially):
#    post-create-command = ["npm install", "npm run build"]
#
# 3. Named table (runs sequentially in declaration order):
# [post-create-command]
# install = "npm install --frozen-lockfile"
# build = "npm run build"

# Post-Start Commands
# Runs in BACKGROUND as detached processes (parallel)
# Use for: dev servers, file watchers, long-running tasks
# The worktree switch completes immediately, these run in parallel
# Output is logged to ~/.cache/worktrunk/logs/{repo}/{branch}/{command}.log
#
# Format options:
# 1. Single string:
#    post-start-command = "npm run dev"
#
# 2. Array (runs in parallel):
#    post-start-command = ["npm run dev", "npm run watch"]
#
# 3. Named table (runs in parallel):
# [post-start-command]
# server = "npm run dev"
# watch = "npm run watch"

# Pre-Commit Commands
# Runs SEQUENTIALLY before committing changes (blocking, fail-fast)
# All commands must exit with code 0 for commit to proceed
# Use for: formatters, linters, quick validation
#
# Format options same as post-create-command
# pre-commit-command = "cargo fmt -- --check"
#
# Or multiple:
# [pre-commit-command]
# format = "cargo fmt -- --check"
# lint = "cargo clippy -- -D warnings"

# Pre-Squash Commands
# Runs SEQUENTIALLY before squashing commits (blocking, fail-fast)
# All commands must exit with code 0 for squash to proceed
# Use for: validation before combining commits
#
# Format options same as post-create-command
# pre-squash-command = "cargo test"

# Pre-Merge Commands
# Runs SEQUENTIALLY before merging to target branch (blocking, fail-fast)
# All commands must exit with code 0 for merge to proceed
# Use for: tests, linters, build verification before merging
#
# Format options same as post-create-command
# pre-merge-command = ["cargo test", "cargo build"]
#
# Or named:
# [pre-merge-command]
# test = "cargo test"
# build = "cargo build --release"

# Post-Merge Commands
# Runs SEQUENTIALLY in the main worktree after successful merge (blocking)
# Runs after push succeeds but before cleanup
# Use for: updating production builds, notifications, cleanup
#
# Format options same as post-create-command
# post-merge-command = "cargo install --path ."

# Example: Node.js Project
# [post-create-command]
# install = "npm ci"
#
# [post-start-command]
# server = "npm run dev"
#
# [pre-merge-command]
# lint = "npm run lint"
# test = "npm test"

# Example: Rust Project
# [post-create-command]
# build = "cargo build"
#
# [pre-merge-command]
# format = "cargo fmt -- --check"
# clippy = "cargo clippy -- -D warnings"
# test = "cargo test"
#
# post-merge-command = "cargo install --path ."

# Example: Python Project
# [post-create-command]
# venv = "python -m venv .venv"
# install = ".venv/bin/pip install -r requirements.txt"
#
# [pre-merge-command]
# format = ".venv/bin/black --check ."
# lint = ".venv/bin/ruff check ."
# test = ".venv/bin/pytest"
